<!DOCTYPE html>
<html lang="en"><!-- #BeginTemplate "/Templates/secondary2.dwt" --><!-- DW6 -->

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="Author" content="Chris K. Caldwell">
  <!-- #BeginEditable "doctitle" -->
  <title>How many primes are there?</title>
  <!-- #EndEditable --> <!-- #BeginEditable "description" -->
  <meta name="description"
    content="The prime number theorem tells us the number of primes less than n is about 1/ln(n).  This pages includes history, theorems, related results and open questions.">
  <meta name="keywords"
    content="prime, primes, prime number theorem, number theory, mathematics, how many, Reimann, counting">
  <!-- #EndEditable -->
  <!-- PrimePage icon -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <!-- Font Awesome ((used anywhere?))-->
  <!-- rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" -->
  <!-- Google Fonts Roboto -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
  <!-- Bootstrap core CSS -->
  <!-- link rel="stylesheet" href="mdb/css/bootstrap.min.css" -->
  <link href="css/bootstrap-4.3.1.css" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="mdb/css/mdb.min.css">
  <!-- Your custom styles (optional) -->
  <link rel="stylesheet" href="mdb/css/mystyle.css">
  <!-- link rel="stylesheet" media="print" href="print.css" / -->
</head>

<body>

  <!--Main Navigation-->
  <header>
    <!--Navbar-->
    <nav class="navbar navbar-expand-lg navbar-dark indigo darken-3">

      <!-- Additional container -->
      <div class="container">

        <!-- Navbar brand -->
        <a class="navbar-brand" href="/">PrimePages</a>

        <!-- Collapse button -->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
          aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation"> <span
            class="navbar-toggler-icon"></span> </button>

        <!-- Collapsible content -->
        <div class="collapse navbar-collapse" id="basicExampleNav">

          <!-- Links -->
          <ul class="navbar-nav mr-auto">
            <!-- Dropdown -->
            <li class="nav-item active dropdown"> <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink"
                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="menu">5000 Largest</a>
              <div class="dropdown-menu dropdown-primary" aria-labelledby="navbarDropdownMenuLink">
                <a class="dropdown-item" href="/primes/">5000 Largest</a>
                <a class="dropdown-item" href="/top20/">Top 20 Primes</a>
                <a class="dropdown-item" href="/bios/">Prover Bios</a>
                <a class="dropdown-item" href="/primes/search.php">Search Primes</a>
              </div>
            </li>
            <li class="nav-item"> <a class="nav-link" href="/notes/faq/">FAQ</a></li>
            <li class="nav-item"> <a class="nav-link" href="/curios/">Curios!</a></li>
            <li class="nav-item"> <a class="nav-link" href="/glossary/">Glossary</a></li>
          </ul>
          <!-- Links -->
          <script> <!-- w3.org claims this is unnecessary:  type="text/javascript" -->
            function Gsitesearch(curobj) {
              curobj.q.value = "site:t5k.org " + curobj.qfront.value
            }
          </script>
          <form class="form-inline" action="https://www.google.com/search" onSubmit="Gsitesearch(this)">
            <div class="md-form my-0">
              <input name="q" type="hidden">
              <input name="qfront" class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
            </div>
          </form>
        </div>
        <!-- Collapsible content -->

      </div>
      <!-- Additional container -->

    </nav>
    <!--/.Navbar-->
  </header>
  <!--Main Navigation-->
  <header class="page-footer black p-0">
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb black p-1">
          <li class="breadcrumb-item"><a class="white-text" href="/">Home</a></li>
          <!-- #BeginEditable "path" -->
          <li class="breadcrumb-item active">How many primes are there?</li>
          <!-- #EndEditable -->
        </ol>
      </nav>
    </div>
  </header>
  <!--Main layout-->
  <main class="mt-5">
    <!-- <div class="m-5 mt-n5 alert alert-danger flex-center" role="alert">  </div>  -->
    <!--Main container-->
    <div class="container">
      <h1 class="mt-n4 mb-4 rounded blue lighten-2 p-2 pl-4 z-depth-2"> <!-- #BeginEditable "title" --> How Many
        Primes<span class="d-none d-md-inline"> are There</span>? <!-- #EndEditable --></h1>
      <!-- #BeginEditable "content" -->

      <!-- Footer -->
      <h3 id="contents">Contents:</h3>
      <ol>
        <li><a href="#intro">Introduction:</a> Asking the Correct Question
          <ul>
            <li><a href="#pi_def">&pi;(<i>x</i>) is the number of primes less than or
                equal to <i>x</i></a></li>
            <li><a href="#table">A Table of values of &pi;(<i>x</i>)</a></li>
          </ul>
        </li>
        <li><a href="#pnt">The Prime Number Theorem</a>
          <ul>
            <li><a href="#1">Consequence One:</a> You can Approximate &pi;(<i>x</i>) with <i>x</i>/(ln <i>x</i> - 1)
            </li>
            <li><a href="#2">Consequence Two:</a> The <i>n</i>th prime is about <i>n</i> ln <i>n</i></li>
            <li><a href="#3">Consequence Three:</a> The chance of a random integer <i>x</i> being prime is about 1/ln
              <i>x</i>
            </li>
          </ul>
        </li>
        <li><a href="#hist">History</a> of the Prime Number Theorem and other approximations
          of &pi;(<i>x</i>)</li>
        <li><a href="#better">There are better estimates!</a></li>
      </ol>
      <h2 class="my-4" id="intro"><a href="#contents"><img src="gifs/up.gif" alt="[up]" width="28"
            height="28"></a>&nbsp;&nbsp;
        1. Introduction: Asking the Correct Question</h2>
      <p>Over 2,300 years ago <a href="/notes/proofs/infinite/">Euclid proved</a> that the
        number of primes is infinite, so two possible questions come to mind:</p>
      <ol>
        <li>Let <em>x</em> &gt; 0. How many primes are there less than the number x?</li>
        <li>There are infinitely many primes, but how big of an infinity?</li>
      </ol>
      <p>This document will focus on the first question.&nbsp; The second question is
        discussed on the page &quot;<a href="infinity.html">How Big of an Infinity?</a>.&quot;</p>

      <h3 class="my-4" id="pi_def">1.1. &pi;(<i>x</i>) is the number of primes less than or equal to <i>x</i></h3>
      <p>Let <i>x</i> be a positive real number.&nbsp; The question &quot;how many
        primes are there less than <i>x</i>?&quot; has been asked so frequently that its
        answer has a name:</p>
      <div class="ml-4 mb-3"> <b>&pi;(<i>x</i>) = the number of primes less than or equal to <i>x</i>.</b> </div>
      <p>The primes under 25 are 2, 3, 5, 7, 11, 13, 17, 19 and 23 so &pi;(3) = 2, &pi;(10) =
        4 and &pi;(25) = 9.&nbsp; (A longer table can be found in the <a href="#table">next
          sub-section</a>.)&nbsp; Look at the following graph and notice how irregular the
        graph of &pi;(<i>x</i>) is for small values of <i>x</i>.</p>

      <img class="mx-auto img-fluid d-block my-2" alt="[Graph of &pi;(x), 0&lt;x&lt;100]" src="gifs/pi100.gif">

      Now back up and view a larger portion of the graph of &pi;(<i>x</i>).

      <img class="mx-auto img-fluid d-block my-2" alt="[Graph of &pi;(x), 0&lt;x&lt;1000]" src="gifs/pi1000.gif">

      <p>So even though &pi;(<i>x</i>) is <a href="notes/gaps.html">&quot;locally&quot;
          irregular</a>, there is a definite trend to its values.&nbsp; (<a href="gifs/pi1000000.gif">Graph to
          1,000,000</a>.)</p>
      <p> In this document we will study the function &pi;(<i>x</i>), the prime number theorem (which quantifies this
        trend) and several classical approximation to &pi;(<i>x</i>).</p>
      <h3 class="my-4">1.2. A Table of values of &pi;(<i>x</i>)</h3>
      <p>For the <i>smaller</i> values of <i>x</i> in this table (say to 10,000,000,000)
        the value of &pi;(<i>x</i>) can be found by finding and counting all of the
        primes.</p>
      <p>Before the age of computers many mathematicians formed tables of primes.&nbsp;
        The most widely distributed was D. N. Lehmer's table of primes to 10,006,721 [<a
          href="/references/refs.cgi/Lehmer14">Lehmer14</a>].&nbsp;
        By far the most amazing was a table by Kulik completed in 1867.&nbsp; This table
        listed the smallest factors of integers (hence all the primes) up to
        100,330,200!</p>
      <p>In the 1870's Meissel developed a clever way to calculate &pi;(<i>x</i>) far
        beyond the known tables of primes and in 1885 (slightly mis-)calculated &pi;(10<sup>9</sup>).&nbsp;
        Meissel's methods were simplified by D. H. Lehmer in 1959 and then in 1985
        improved using sieve techniques by Lagarias, Miller and Odlyzko [<a
          href="/references/refs.cgi/LMO85">LMO85</a>].</p>
      <p>In 1994 Del&eacute;glise and Rivat [<a href="/references/refs.cgi/DR96">DR96</a>]
        improved the technique once again to find the values for &pi;(10<sup>17</sup>) and
        &pi;(10<sup>18</sup>).&nbsp; Del&eacute;glise continued this work with an improved
        algorithm to find &pi;(10<sup>20</sup>) and other values (see his e-mail messages
        of <a href="notes/md.html">18 Apr 1996</a> and <a href="notes/md6-96.html">19
          Jun 1996</a>).&nbsp; See <a href="/references/refs.cgi/Riesel94">Riesel94</a> for
        practical information about how these calculations are made.</p>
      <p> Xavier Gourdon's distributed computing project determined &pi;(4*10<sup>22</sup>), <a
          href="http://numbers.computation.free.fr/Constants/Primes/Pix/pixproject.html">but
          stopped when they found</a> an error of at least one in the calculation of
        &pi;(10<sup>23</sup>).&nbsp;
        Tom&aacute;s Oliveira e Silva has <a href="http://sweet.ua.pt/tos/primes.html">extensive
          tables of values</a> of &pi;(<i>x</i>) and pi<sub>2</sub>(<i>x</i>). In 2007
        he reevaluated &pi;(10<sup>23</sup>) to get the value in
        the table.&nbsp; This calculation was done on a single machine and
        verified in 2008. </p>
      <div class="container-fluid w-75" id="table">
        <div class="row">
          <div class="col-12 text-center font-weight-bold"> Table 1.&nbsp; Values of &pi;(<i>x</i>) </div>
        </div>
        <div class="row blue lighten-4">
          <div class="col-1 d-none d-md-block"><i>n</i></div>
          <div class="col-5 col-md-7 col-lg-5 text-right"><i>x</i></div>
          <div class="col-5 col-md-2 col-lg-5 text-right">&pi;(<i>x</i>)</div>
          <div class="col-2 col-md-2 col-lg-1 d-none d-lg-block">ref</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">1</div>
          <div class="col-8 col-lg-5 text-right">10</div>
          <div class="col-10 col-lg-5 text-right">4</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">2</div>
          <div class="col-8 col-lg-5 text-right">100</div>
          <div class="col-10 col-lg-5 text-right">25</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">3</div>
          <div class="col-8 col-lg-5 text-right">1,000</div>
          <div class="col-10 col-lg-5 text-right">168</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">4</div>
          <div class="col-8 col-lg-5 text-right">10,000</div>
          <div class="col-10 col-lg-5 text-right">1,229</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">5</div>
          <div class="col-8 col-lg-5 text-right">100,000</div>
          <div class="col-10 col-lg-5 text-right">9,592</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">6</div>
          <div class="col-8 col-lg-5 text-right">1,000,000</div>
          <div class="col-10 col-lg-5 text-right">78,498</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">7</div>
          <div class="col-8 col-lg-5 text-right">10,000,000</div>
          <div class="col-10 col-lg-5 text-right">664,579</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">8</div>
          <div class="col-8 col-lg-5 text-right">100,000,000</div>
          <div class="col-10 col-lg-5 text-right">5,761,455</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">9</div>
          <div class="col-8 col-lg-5 text-right">1,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">50,847,534</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">10</div>
          <div class="col-8 col-lg-5 text-right">10,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">455,052,511</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">11</div>
          <div class="col-8 col-lg-5 text-right">100,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">4,118,054,813</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">12</div>
          <div class="col-8 col-lg-5 text-right">1,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">37,607,912,018</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">13</div>
          <div class="col-8 col-lg-5 text-right">10,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">346,065,536,839</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">14</div>
          <div class="col-8 col-lg-5 text-right">100,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">3,204,941,750,802</div>
          <div class="col-2 col-lg-1">[<a href="/references/refs.cgi/LMO85">LMO85</a>]</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">15</div>
          <div class="col-8 col-lg-5 text-right">1,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">29,844,570,422,669</div>
          <div class="col-2 col-lg-1">[<a href="/references/refs.cgi/LMO85">LMO85</a>]</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">16</div>
          <div class="col-8 col-lg-5 text-right">10,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">279,238,341,033,925</div>
          <div class="col-2 col-lg-1">[<a href="/references/refs.cgi/LMO85">LMO85</a>]</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">17</div>
          <div class="col-8 col-lg-5 text-right">100,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">2,623,557,157,654,233</div>
          <div class="col-2 col-lg-1">[<a href="/references/refs.cgi/DR96">DR96</a>]</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">18</div>
          <div class="col-8 col-lg-5 text-right">1,000,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">24,739,954,287,740,860</div>
          <div class="col-2 col-lg-1">[<a href="/references/refs.cgi/DR96">DR96</a>]</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">19</div>
          <div class="col-8 col-lg-5 text-right">10,000,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">234,057,667,276,344,607</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">20</div>
          <div class="col-8 col-lg-5 text-right">100,000,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">2,220,819,602,560,918,840</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">21</div>
          <div class="col-8 col-lg-5 text-right">1,000,000,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">21,127,269,486,018,731,928</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">22</div>
          <div class="col-8 col-lg-5 text-right">10,000,000,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">201,467,286,689,315,906,290</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">23</div>
          <div class="col-8 col-lg-5 text-right">100,000,000,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">1,925,320,391,606,803,968,923</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">24</div>
          <div class="col-8 col-lg-5 text-right">1,000,000,000,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">18,435,599,767,349,200,867,866</div>
          <div class="col-2 col-lg-1 text-center">(<a href="notes/pi(10to24).html">note</a>)</div>
        </div>
        <div class="row">
          <div class="col-1 d-none d-md-block">25</div>
          <div class="col-8 col-lg-5 text-right">10,000,000,000,000,000,000,000,000</div>
          <div class="col-10 col-lg-5 text-right">176,846,309,399,143,769,411,680</div>
          <div class="col-2 col-lg-1">&nbsp;</div>
        </div>
        <div class="row blue lighten-4">
          <div class="col-12">&nbsp;</div>
        </div>
      </div>
      <br>
      <p>The value given for &pi;(10<sup>24</sup>) was found by an analytic methods assuming the
        unproven
        Riemann Hypothesis by J. Buethe, J. Franke, A. Jost, T. Kleinjung. Their method &quot;is
        similar to the one described by Lagarias and Odlyzko, but uses the Weil explicit formula
        instead of complex curve integrals&quot; (see their <a href="notes/pi(10to24).html">e-mail
          announcing the result</a> in July 2010). This value was later verified unconditionally
        by D. J. Platt [<a href="/references/refs.cgi/Platt2012">Platt2012</a>].</p>
      <p>In May 2013, J. Buethe, J. Franke, A. Jost, and T. Kleinjung completed calculating &pi;(10^25)
        unconditionally, using an analytic method based on Weil's explicit formula.</p>
      <hr>
      <h2 class="my-4" id="pnt"><a href="#contents"><img src="gifs/up.gif" alt="[up]" width="28"
            height="28"></a>&nbsp;&nbsp; 2. The Prime Number Theorem: approximating &pi;(<i>x</i>)</h2>
      <p>Even though the distribution of primes seems random (there are (probably)
        infinitely many twin primes and there are (definitely) arbitrarily large gaps
        between primes), the function &pi;(<i>x</i>) is surprisingly well behaved: In
        fact, it has been proved (see the <a href="#hist">next section</a>) that:</p>
      <div class="ml-4 mb-3"> <b>The Prime Number Theorem:</b> The number of primes not exceeding <i>x</i> is
        <strong>asymptotic</strong> to <i>x</i>/ln <i>x</i>.
      </div>
      <p>In terms of &pi;(<i>x</i>) we would write:</p>
      <div class="ml-4 mb-3"><b>The Prime Number Theorem:</b> &pi;(<i>x</i>) ~ <i>x</i>/ln <i>x</i>. </div>
      <p>This means (roughly) that <i>x</i>/ln <i>x</i> is a good approximation for &pi;(<i>x</i>)--but
        before we consider this and other consequences lets be a little more specific:</p>
      <blockquote class="blockquote"> &quot;<i>a</i>(<i>x</i>) is <b>asymptotic</b> to <i>b</i>(<i>x</i>)&quot; and
        &quot;<i>a</i>(<i>x</i>) <b>~</b> <i>b</i>(<i>x</i>)&quot; both mean that the
        limit (as <i>x</i> approaches infinity) of the ratio <i>a</i>(<i>x</i>)/b(<i>x</i>)
        is 1. </blockquote>
      <p>If you have not had calculus then this means that you can make <i>a</i>(<i>x</i>)/<i>b</i>(<i>x</i>)
        as close to 1 as you want by just requiring that <i>x</i> is large enough.&nbsp;
        Warning: <i>a(<i>x</i>)</i>&nbsp;~&nbsp;<i>b(<i>x</i>)</i> does <i>not</i> mean
        that <i>a</i>(<i>x</i>)-<i>b</i>(<i>x</i>) is small!&nbsp; For example, <i>x</i><sup>2</sup> is asymptotic to
        <i>x</i><sup>2</sup>-<i>x</i>, but the difference between them, <i>x</i>, gets arbitrarily large as <i>x</i>
        goes to infinity.
      </p>
      <h3 class="my-4" id="1">Consequence One: You can Approximate &pi;(<i>x</i>) with <i>x</i>/(ln <i>x</i> - 1)</h3>
      <div class="float-right">
        <div class="w-100 text-center font-weight-bold">
          <b>Table 2.&nbsp; &pi;(<i>x</i>) verse <i>x</i>/ln <i>x</i></b>
        </div>
        <table class="text-right blue lighten-5">
          <tr class="blue lighten-3">
            <th> <i>x</i></th>
            <th>&pi;(<i>x</i>)</th>
            <th><i>x</i>/ln <i>x</i></th>
            <th><i>x</i>/(ln <i>x</i> -1)</th>
          </tr>
          <tr>
            <td>1000</td>
            <td>168</td>
            <td>145</td>
            <td>169</td>
          </tr>
          <tr>
            <td>10000</td>
            <td>1229</td>
            <td>1086</td>
            <td>1218</td>
          </tr>
          <tr>
            <td>100000</td>
            <td>9592</td>
            <td>8686</td>
            <td>9512</td>
          </tr>
          <tr>
            <td>1000000</td>
            <td>78498</td>
            <td>72382</td>
            <td>78030</td>
          </tr>
          <tr>
            <td>10000000</td>
            <td>664579</td>
            <td>620420</td>
            <td>661459</td>
          </tr>
          <tr>
            <td>100000000</td>
            <td>5761455</td>
            <td>5428681</td>
            <td>5740304</td>
          </tr>
        </table>
      </div>
      <p>The prime number theorem clearly implies that you can use <i>x</i>/(ln <i>x</i> - <i>a</i>) (with any constant
        <i>a</i>) to approximate &pi;(<i>x</i>).&nbsp; The
        prime number theorem was stated with <i>a</i>=0, but <a href="#better">it has
          been shown</a> that <i>a</i>=1 is the best choice.
      </p>
      <p>There are longer tables <a href="#table3">below</a> and (of &pi;(x) only) <a href="#table">above</a>.</p>
      <blockquote class="blockquote"> <b>Example:</b> Someone recently e-mailed me and asked for a list of <i>all</i>
        the primes with at most 300 digits.&nbsp; Since the prime number theorem
        implies this list would have about 1.4*10<sup>297</sup> entries we know that
        there can be no such list! </blockquote>
      <p>Note that Pierre Dusart [<a href="/references/refs.cgi/Dusart99">Dusart99</a>]
        showed that if <i>x</i>&gt;598 then</p>
      <div class="ml-4 mb-3"> (<i>x</i>/ln <i>x</i>)(1 + 0.992/ln <i>x</i>) <u>&lt;</u> &pi;(<i>x</i>)
        <u>&lt;</u>(<i>x</i>/ln <i>x</i>)(1 + 1.2762/ln <i>x</i>)
      </div>
      (The upper bound holds for all <i>x</i> &gt; 1.)&nbsp; This gives a tight bound
      for larger <i>x</i>. Note <i>x</i>/ln <i>x</i><u>&lt;</u> &pi;(<i>x</i>) for <i>x</i> &gt; 10.
      <h3 class="my-4" id="2">Consequence Two: The <i>n</i>th prime is about <i>n</i> ln <i>n</i></h3>
      <p>Let p(<i>n</i>) be the <i>n</i>th prime.&nbsp; It is easy to show that the prime
        number theorem is equivalent to the statement</p>
      <div class="ml-4 mb-3"> <b>Theorem:</b> p(<i>n</i>) ~ <i>n</i> ln <i>n</i> </div>
      <p>[see <a href="/references/refs.cgi/HW79">Hardy and Wright</a>, page 10].&nbsp;&nbsp;A
        better estimate is</p>
      <div class="ml-4 mb-3"> <b>Theorem:</b> p(<i>n</i>) ~ <i>n </i>(ln <i>n</i> + ln ln <i>n</i> - 1) </div>
      <p>[see <a href="/references/refs.cgi/Ribenboim95">Ribenboim95</a>, pg. 249].</p>
      <blockquote class="blockquote"> <b>Example:</b> These formulae predict that the one millionth prime is about
        13,800,000 and 15,400,000 respectively.&nbsp; In fact, the one millionth prime
        is 15,485,863. </blockquote>
      <p>There have been many improvements on these bounds; for example, Robin [<a
          href="/references/refs.cgi/Robin83">Robin83</a>]
        showed that if <i>n</i>&gt;8601 [actually Robin erroneously used 7021], then</p>
      <div class="ml-4 mb-3"> <i>n </i>(ln <i>n</i> + ln ln <i>n</i> - 1.0073) &lt; p(<i>n</i>) &lt; <i>n </i>(ln
        <i>n</i> + ln ln <i>n</i> - 0.9385)
      </div>
      <p>More recently Massias and Robin [<a href="/references/refs.cgi/MR96">MR96</a>]
        showed that if <i>n</i> <u>&gt;</u> 15985, then</p>
      <div class="ml-4 mb-3"> p(<i>n</i>) <u>&lt;</u> <i>n</i> (ln <i>n</i> + ln ln <i>n</i> - 0.9427) </div>
      <p>and if <i>n</i> <u>&gt;</u> 13, then</p>
      <div class="ml-4 mb-3"> p(<i>n</i>) <u>&lt;</u> <i>n</i> (ln <i>n</i> + ln ln <i>n</i> - 1 + 1.8
        ln ln <i>n</i> / ln <i>n</i>) </div>
      <p>(which is better for large <i>n</i>). Pierre Dusart [<a href="/references/refs.cgi/Dusart99">Dusart99</a>]
        made these results stronger and showed</p>
      <div class="ml-4 mb-3"> p(<i>n</i>) &gt; <i>n</i> (ln <i>n</i> + ln ln <i>n</i> - 1) </div>
      <p>for all <i>n</i>.&nbsp; Dusart's article also gives better bounds getting even
        closer to the next term in the following well known asymptotic expansion for <i>p<sub>n</sub></i>.&nbsp;
        The first terms of this asymptotic expansion were given by Cipolla
        [<a href="references/refs.cgi/Cipolla1902">Cipolla1902</a>] in 1902: </p>
      <div class="ml-4 mb-3"> p(<i>n</i>) = <i>n</i> (ln <i>n</i> + ln ln <i>n</i> - 1 + (ln ln (<i>n</i>) - 2)/ln
        <i>n</i> -<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        ((ln ln (<i>n</i>))<sup>2</sup> - 6 ln ln (<i>n</i>) + 11)/(2 log<sup>2</sup> <i>n</i>) + O((ln ln <i>n</i> / ln
        <i>n</i>)<sup>3</sup>))
      </div>
      <p>Again <a href="/references/refs.cgi/Ribenboim95">Ribenboim95</a> and <a
          href="/references/refs.cgi/Riesel94">Riesel94</a> are excellent starting places to look up more information.
        By the way, if you
        are interested in the <i>n</i>th prime for small <i>n</i> (say less than
        1,000,000,000), then use <a href="/nthprime/">the <i>n</i>th prime page</a>.&quot;</p>
      <h3 class="my-4" id="3">Consequence Three: The chance of a random integer <i>x</i> being
        prime is about 1/ln <i>x</i></h3>
      <p>Let <i>x</i> be a positive integer. Since about <i>x</i>/ln <i>x</i> of the <i>x</i> positive integers less
        than or equal to <i>x</i> are prime, the probability of
        one of them being prime is about 1/ln <i>x</i>.</p>
      <blockquote class="blockquote"> <b>Example:</b> Suppose I want to find a 1000 digit prime.&nbsp; If I am
        choosing 1000 digit integers <i>x</i> to <a href="/prove/">test for primality</a> <i>at random</i>, then I'd
        expect to test about ln(10<sup>1000</sup>) of
        them, or about 2302 integers before finding a prime.&nbsp; Obviously if I used
        odd integers I could multiply this estimate by 1/2, and if I choose integers
        not divisible by 3, then I could multiply by 2/3,... </blockquote>
      <p>Another way to say this is that the density of primes less than <em>x</em> is
        about 1/ln <i>x</i>.&nbsp; Below is a graph of the actual density for small
        values of <em>x</em>.</p>
      <img class="mx-auto img-fluid d-block my-2" src="gifs/density.gif" alt="The density of the primes from 0 to 200">
      <h2 class="my-4" id="hist"><a href="#contents"><img src="gifs/up.gif" alt="[up]" width="28"
            height="28"></a>&nbsp;&nbsp;
        3. History of the Prime Number Theorem</h2>
      <p>In 1798 Legendre published the first significant conjecture on the size of &pi;(<i>x</i>),
        when in his book <i>Essai sur la Th&eacute;ie des Nombres</i> he stated</p>
      <div class="ml-4 mb-3"><b>Legendre:</b> &pi;(<i>x</i>) is approximately <i>x</i>/(ln <i>x</i> - 1.08366) </div>
      <p>Clearly Legendre's conjecture is equivalent to the prime number theorem, the
        constant 1.08366 was based on his limited table for values of &pi;(<i>x</i>)
        (which only went to <i>x</i> = 400,000).&nbsp; In the long run 1 is <a href="#better">a
          better choice</a> than Legendre's 1.08366.</p>
      <p>Gauss was also studying prime tables and came up with a different estimate
        (perhaps first considered in 1791), communicated in a letter to Encke in 1849
        and first published in 1863.</p>
      <div class="ml-4 mb-3"> <b>Gauss:</b> &pi;(<i>x</i>) is approximately Li(<i>x</i>) (the principal value of
        integral of 1/ln <i>u</i> from <i>u</i>=0 to <i>u</i>=<i>x</i>). </div>
      <p>Notice again that Gauss' conjecture is equivalent to the prime number theorem.&nbsp;
        Let's compare these estimates:</p>
      <div class="float-right mb-3">
        <div class="row w-100">
          <div class="col-12 text-center font-weight-bold"> Table 3. Comparisons of approximations to &pi;(x) </div>
        </div>
        <div class="row">
          <div class="col-12">
            <table class="ml-4 text-right blue lighten-5" id="table3">
              <tr class="blue lighten-3 text-right">
                <th><i>x</i></th>
                <th>&pi;(<i>x</i>)</th>
                <th>Gauss' Li</th>
                <th>Legendre</th>
                <th><i>x</i>/(ln <i>x</i> - 1)</th>
                <th>R(<i>x</i>)</th>
              </tr>
              <tr>
                <td>1000</td>
                <td>168</td>
                <td>178</td>
                <td>172</td>
                <td>169</td>
                <td>168.4</td>
              </tr>
              <tr>
                <td>10000</td>
                <td>1229</td>
                <td>1246</td>
                <td>1231</td>
                <td>1218</td>
                <td>1226.9</td>
              </tr>
              <tr>
                <td>100000</td>
                <td>9592</td>
                <td>9630</td>
                <td>9588</td>
                <td>9512</td>
                <td>9587.4</td>
              </tr>
              <tr>
                <td>1000000</td>
                <td>78498</td>
                <td>78628</td>
                <td>78534</td>
                <td>78030</td>
                <td>78527.4</td>
              </tr>
              <tr>
                <td>10000000</td>
                <td>664579</td>
                <td>664918</td>
                <td>665138</td>
                <td>661459</td>
                <td>664667.4</td>
              </tr>
              <tr>
                <td>100000000</td>
                <td>5761455</td>
                <td>5762209</td>
                <td>5769341</td>
                <td>5740304</td>
                <td>5761551.9</td>
              </tr>
              <tr>
                <td>1000000000</td>
                <td>50847534</td>
                <td>50849235</td>
                <td>50917519</td>
                <td>50701542</td>
                <td>50847455.4</td>
              </tr>
              <tr>
                <td>10000000000</td>
                <td>455052511</td>
                <td>455055614</td>
                <td>455743004</td>
                <td>454011971</td>
                <td>455050683.3</td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <br>
      <p>In this table Gauss' Li(<i>x</i>) is always larger than &pi;(<i>x</i>), this is
        true for all small <i>x</i> <u>&gt;</u> 2.&nbsp; However in 1914 Littlewood
        proved that &pi;(<i>x</i>)-Li(<i>x</i>) assumes both positive and negative values
        infinitely often.&nbsp; In 1986 Te Riele showed there are more than 10<sup>180</sup> successive integers
        <i>x</i> for which &pi;(<i>x</i>)&gt;Li(<i>x</i>) between 6.62<sup>.</sup>10<sup>370</sup> and
        6.69<sup>.</sup>10<sup>370</sup>.
      </p>
      <p>Tchebycheff made the first real progress toward a proof of the prime number
        theorem in 1850, showing there exist positive constants <i>a</i> <u>&lt;</u> 1 <u>&lt;</u> <i>b</i> such that
      </p>
      <div class="ml-4 mb-3"> <i>a</i>(<i>x</i>/ln <i>x</i>) &lt; &pi;(<i>x</i>) &lt; <i>b</i>(<i>x</i>/ln <i>x</i>)
      </div>
      <p>and that <strong>if</strong> &pi;(<i>x</i>)/(x/ln x) had a limit, then its value
        must be one.&nbsp; Sylvester in 1982 refined Tchebycheff's method and showed
        that we can use <i>a</i> = 0.95695 and <i>b</i> = 1.04423 if <i>x</i> is large
        enough.&nbsp; (In 1962 it was shown that we can use <i>a</i> = 1 for all <i>x</i> &gt; 10 [<a
          href="/references/refs.cgi/RS62">RS62</a>].)</p>
      <p>Finally, in 1896 Hadamard and independently de la Vall&eacute;e Poussin <b>completely
          proved the prime number theorem</b> using Riemann's work relating &pi;(<i>x</i>)
        to the complex zeta function.&nbsp; de la Vall&eacute;e Poussin also proved
        that Gauss' Li(<i>x</i>) is a better approximation to &pi;(<i>x</i>) than x/(ln <i>x</i> -<i>a</i>) no matter
        what value is assigned to the constant <i>a</i> (and also that the best value for <i>a</i> is 1).&nbsp; A much
        better approximation
        than any of these is the Riemann function [<a href="/references/refs.cgi/Ribenboim91">Ribenboim91</a>, <a
          href="/references/refs.cgi/Riesel94">Riesel94</a>].</p>
      <p>In 1949 Atle Selberg [<a href="/references/refs.cgi/Selberg49">Selberg49</a>]
        and Paul Erd&ouml;s [<a href="/references/refs.cgi/Erdos49">Erd&ouml;s49</a>]
        independently gave the first elementary proofs of the prime number theorem--
        here elementary means not using modern complex analysis--in fact their proofs
        are very difficult!&nbsp; An easier to read (but less elementary) proof is in
        Hardy and Wright's text [<a href="/references/refs.cgi/HW79">HW79</a> sect.
        22.15-16].</p>
      <p>Finally, when Hadamard and de la Vall&eacute;e Poussin proved the <a href="#pnt">Prime
          number theorem</a>, they actually showed</p>
      <div class="ml-4 mb-3"> <img src="gifs/pnt_2.gif" alt="&pi;(x) = Li(x) + O(x*e^(-a*sqrt(ln x)))" width="200">
      </div>
      <p>for some positive constant <i>a</i>.&nbsp; The error term depended on what was
        known about the zero-free region of the Riemann zeta function within the
        critical strip.&nbsp; As our knowledge of the size of this region increases, the
        error term decreases.&nbsp; In 1901 von Koch showed that the <a href="notes/rh.html">Riemann
          hypothesis</a> is equivalent to the far tighter estimate:</p>
      <div class="ml-4 mb-3"> <img src="gifs/pnt_1.gif" alt="&pi;(x) = Li(x) + O(x^(1/2)ln x)" width="200"> </div>
      <h2 class="my-4" id="better"><a href="#contents"><img src="gifs/up.gif" alt="[up]" width="28"
            height="28"></a>&nbsp;&nbsp; 4.
        More Accurate Estimates </h2>
      <img src="gifs/pi(x)R(x).gif" alt="Graph showing R(x) approximates &pi;(x) well" class="float-right">
      <p>This page focused on the prime number theorem in it simplest form, but there
        are far better estimates for &pi;(<i>x</i>).&nbsp; To cut to the chase, the Riemann zeta function provides a way
        to give an exact formula
        for &pi;(<i>x</i>) by summing over the non-trivial zeros of the zeta function (in order of increasing
        magnitude).</p>
      <div class="ml-4 mb-3"> <img src="gifs/exact.gif" alt="An exact formula for &pi;(x)"> </div>
      <p>(At the primes, the graph of &pi;(<i>x</i>) takes a step up one unit, this formula approches the value in the
        middle of that
        step.)&nbsp;
        The first (and dominant) term above is called Riemann's function R(<i>x</i>).
      </p>
      <div class="ml-4 mb-3"> <img src="gifs/R(x)def.gif" alt="The definition of R(x)"> </div>
      <p>The last form above for R(<i>x</i>) is the Graham series and is an excellent way to calculate this
        function.&nbsp;
        The graph on the right shows how close of an approximaton R(<i>x</i>)
        is, at least for small values of <i>x</i>.&nbsp;
        An even better one for the smallest small <i>x</i> values is the following (they are essentially the same for
        large <i>x</i>).</p>
      <div class="ml-4 mb-3"> <img src="gifs/R(x)appx.gif" alt="An approximation to \&pi;(x) by R(x)"> </div>
      <p>To appreciate how close of an approximation these are, see the <a
          href="http://www.primefan.ru/stuff/primes/table.html">impressive tables of deviations</a> by Andrey Kulsha.
      </p>
      <p>Matthew R. Watkins also has a
        <a href="http://empslocal.ex.ac.uk/people/staff/mrwatkin/zeta/encoding1.htm">beautiful
          development</a> of this information and some excellent animations.
      </p>
      <h3 class="my-4">Warning</h3>
      <div class="text-center"> <strong><img src="gifs/PiAndOthers.png" class="img-fluid"
            alt="Graph showing R(x), Li(x) and x/ln(x) approximate &pi;(x)"><br>
        </strong>
        <p class="mt-n3 mb-4"><strong>Figure 4.</strong> Graph showing R(x), Li(x) and x/ln(x) approximate &pi;(x)</p>
      </div>
      <p>It is easy to look at a graph like the one above which shows Li(<i>x</i>) (blue), R(<i>x</i>) (black),
        &pi;(<i>x</i>) (red)
        and <i>x</i>/ln <i>x</i> (green); and then proclaim "R(<i>x</i>) is the best estimate of &pi;(<i>x</i>)." Indeed
        it
        is for that range, but as we mentioned above, Li(<i>x</i>)-&pi;(<i>x</i>)
        changes sign infinitely often, and near where it does, Li(<i>x</i>) would be the best value. <a
          href="/references/refs.cgi/Ingham1990">A. E. Ingham</a> says it this way:</p>
      <blockquote class="blockquote"> Considerable importance was attached formerly to a function suggested by Riemann
        as an approximation to
        &pi;(x)... This function represents &pi;(x) with astonishing accuracy for all values of x for which &pi;(x) has
        been
        calculated, but we now see that its superiority over Li(x) is illusory... and for special values of x (as large
        as
        we please) the one approximation will deviate as widely as the other from the true value.<br>
        <br>
        ... And we can see in the same way that the function Li(x)-(1/2)Li(x<sup>1/2</sup>) is
        'on the average' a better approximation than Li(x) to &pi;(x); but no importance can be attached to the latter
        terms
        in Riemann's formula even by repeated averaging.
      </blockquote>
      <p>The problem is that the contributions from the non-trivial zeros at times swamps that of any but the main terms
        in
        these expansions.</p>
      <!-- #EndEditable -->
    </div>
    <!-- For print copies only -->
    <div class="d-none d-print-block mt-5 pl-3">Printed from the PrimePages &lt;t5k.org&gt; &copy; Reginald McLean.
    </div>
  </main>
  <!--Main container-->

  <footer class="page-footer font-small indigo darken-3 pt-4 mt-4">

    <!-- Footer Links -->
    <div class="container text-center">

      <!-- Grid row -->
      <div class="row">


        <!-- hr class="clearfix w-100 d-md-none pb-3" -->

        <!-- Grid column -->
        <div class="col-sm-4 mt-md-0 mt-3 mb-3">
          <!-- Links -->
          <h5 class="font-weight-bold" id="cc_more">Collections</h5>
          <ul class="list-unstyled">
            <li><a href="/glossary/">Prime Glossary</a></li>
            <li><a href="/curios/">Prime Curios!</a></li>
            <li><a href="/prove/">Proving Primality</a></li>
            <li><a href="/notes/faq/">Frequently Asked Questions</a></li>
            <li><a href="/notes/proofs/">Proofs</a></li>
          </ul>
        </div>
        <!-- Grid column -->

        <!-- Grid column -->
        <div class="col-sm-4 mb-md-0 mb-3">
          <!-- Links -->
          <h5 class="font-weight-bold">Prime Lists</h5>
          <ul class="list-unstyled">
            <li><a href="/largest.html">Largest Known Primes</a></li>
            <li><a href="/primes/">Top 5000 List</a></li>
            <li><a href="/lists/">Lists of Small Primes</a></li>
            <li><a href="/top20/">Records for Different Types</a></li>
            <li><a href="/mersenne/">Mersenne Primes</a></li>
          </ul>
        </div>
        <!-- Grid column -->

        <!-- Grid column -->
        <div class="col-sm-4 mb-md-0 mb-3">
          <!-- Links -->
          <h5 class="font-weight-bold">Pages</h5>
          <ul class="list-unstyled">
            <li> <a href="/donate.php">Donate</a></li>
            <li> <a href="/notes/by_year.html">Largest Known by Year</a></li>
            <li> <a href="/bios/">Prover Bios</a></li>
            <li> <a href="/bios/top20.php">Top 20 Provers</a></li>
            <li> <a href="/primes/includes/mail.php">Contact Us</a></li>
          </ul>
        </div>
        <!-- Grid column -->

      </div>
      <!-- Grid row -->

    </div>
    <!-- Footer Links -->

    <div class="footer-copyright text-center py-3"><!-- #BeginLibraryItem "/Library/copyright.lbi" -->
      Copyright Â© 2021 &nbsp; <a href="https://t5k.org/">PrimePages</a>.&nbsp; (<a href="notes/privacy.html">Privacy
        notice</a>)<!-- #EndLibraryItem --></div>
  </footer>
  <!-- Footer -->

  <!-- THIS WAS NOT IN MD5:  jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <!-- XX script src="../js/jquery-3.3.1.min.js"></script -->
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <!-- XX script src="../js/popper.min.js"></script -->
  <!-- XX script src="../js/bootstrap-4.3.1.js"></script -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
</body>
<!-- #EndTemplate -->

</html>
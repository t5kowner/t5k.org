<!DOCTYPE html>
<html lang="en"><!-- #BeginTemplate "/Templates/secondary2.dwt" --><!-- DW6 -->

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="Author" content="Chris K. Caldwell">
  <!-- #BeginEditable "doctitle" -->
  <title>A proof of Lucas-Lehmer Test</title>
  <!-- #EndEditable --> <!-- #BeginEditable "description" -->
  <meta name="description" content="Here we prove the sufficiency of the 
      Lucas-Lehmer test for the primality of Mersenne numbers. This proof is similar 
      to the proof of all the classical tests in that it relies on a variant of 
      Lagrange's theorem. Another of the Prime Pages' proofs!">
  <!-- #EndEditable -->
  <!-- PrimePage icon -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <!-- Font Awesome ((used anywhere?))-->
  <!-- rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" -->
  <!-- Google Fonts Roboto -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
  <!-- Bootstrap core CSS -->
  <!-- link rel="stylesheet" href="mdb/css/bootstrap.min.css" -->
  <link href="../../css/bootstrap-4.3.1.css" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="../../mdb/css/mdb.min.css">
  <!-- Your custom styles (optional) -->
  <link rel="stylesheet" href="../../mdb/css/mystyle.css">
  <!-- link rel="stylesheet" media="print" href="print.css" / -->
</head>

<body>

  <!--Main Navigation-->
  <header>
    <!--Navbar-->
    <nav class="navbar navbar-expand-lg navbar-dark indigo darken-3">

      <!-- Additional container -->
      <div class="container">

        <!-- Navbar brand -->
        <a class="navbar-brand" href="/">PrimePages</a>

        <!-- Collapse button -->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
          aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation"> <span
            class="navbar-toggler-icon"></span> </button>

        <!-- Collapsible content -->
        <div class="collapse navbar-collapse" id="basicExampleNav">

          <!-- Links -->
          <ul class="navbar-nav mr-auto">
            <!-- Dropdown -->
            <li class="nav-item active dropdown"> <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink"
                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="menu">5000 Largest</a>
              <div class="dropdown-menu dropdown-primary" aria-labelledby="navbarDropdownMenuLink">
                <a class="dropdown-item" href="/primes/">5000 Largest</a>
                <a class="dropdown-item" href="/top20/">Top 20 Primes</a>
                <a class="dropdown-item" href="/bios/">Prover Bios</a>
                <a class="dropdown-item" href="/primes/search.php">Search Primes</a>
              </div>
            </li>
            <li class="nav-item"> <a class="nav-link" href="/notes/faq/">FAQ</a></li>
            <li class="nav-item"> <a class="nav-link" href="/curios/">Curios!</a></li>
            <li class="nav-item"> <a class="nav-link" href="/glossary/">Glossary</a></li>
          </ul>
          <!-- Links -->
          <script> <!-- w3.org claims this is unnecessary:  type="text/javascript" -->
            function Gsitesearch(curobj) {
              curobj.q.value = "site:t5k.org " + curobj.qfront.value
            }
          </script>
          <form class="form-inline" action="https://www.google.com/search" onSubmit="Gsitesearch(this)">
            <div class="md-form my-0">
              <input name="q" type="hidden">
              <input name="qfront" class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
            </div>
          </form>
        </div>
        <!-- Collapsible content -->

      </div>
      <!-- Additional container -->

    </nav>
    <!--/.Navbar-->
  </header>
  <!--Main Navigation-->
  <header class="page-footer black p-0">
    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb black p-1">
          <li class="breadcrumb-item"><a class="white-text" href="/">Home</a></li>
          <!-- #BeginEditable "path" -->
          <li class="breadcrumb-item"><a class="white-text" href="../index.html">Notes</a></li>
          <li class="breadcrumb-item"><a class="white-text" href="./index.html">Proofs</a></li>
          <li class="breadcrumb-item active">Lucas Lehmer Test</li>
          <!-- #EndEditable -->
        </ol>
      </nav>
    </div>
  </header>
  <!--Main layout-->
  <main class="mt-5">
    <!-- <div class="m-5 mt-n5 alert alert-danger flex-center" role="alert">  </div>  -->
    <!--Main container-->
    <div class="container">
      <h1 class="mt-n4 mb-4 rounded blue lighten-2 p-2 pl-4 z-depth-2"> <!-- #BeginEditable "title" -->A
        proof of the Lucas-Lehmer Test<!-- #EndEditable --></h1>
      <h3 class="mt-n3 mb-3 p-2 pl-4 rounded blue lighten-4">By Chris Caldwell</h3>
      <!-- #BeginEditable "content" -->
      <p>Let M<sub><i>p</i></sub> be the <i>p</i>th
        Mersenne number (so M<sub><i>p</i></sub> = 2<i><sup>p</sup></i>-1).&nbsp;
        These numbers are (and always have been) central to the studies of prime
        numbers (see the pages on <a href="/mersenne/index.html">Mersenne
          numbers</a>).&nbsp; What concerns us here is a test for their primality
        first devised by Lucas then simplified by Lehmer:</p>
      <dl>
        <dt><b>Lucas-Lehmer Test</b> (1930).</dt>
        <dd> Let <em>p</em> be an odd prime.&nbsp; M<sub><i>p</i></sub> is prime
          if and only if S(<i>p</i>-1) ≡ 0 (mod M<sub><i>p</i></sub>) where S<sub>1</sub>&nbsp;=&nbsp;4
          and S<i><sub>n</sub></i> = S<sub><i>n</i>-1</sub><sup>2</sup> - 2.</dd>
      </dl>
      <p>The proof is similar to most of the
        <a href="/prove/prove3.html">classical tests</a> and relies
        on the fact that the order of an element divides the order of the group.
        We separate the proof into two parts (I have not yet typed in the proof
        of the necessity.)
      </p>
      <dl>
        <dt>Proof of the sufficiency.</dt>
        <dd>
          <p>We will follow Bruce's proof [<a href="/references/refs.cgi/Bruce93">Bruce93</a>] that if
            the Mersenne M<i><sub>p</sub></i> divides S<sub><i>p</i>-1</sub> (where
            S<sub>1</sub> = 4 and S<i><sub>n</sub></i> = S<sub><i>n</i>-1</sub><sup>2</sup>-2),
            then M<i><sub>p</sub></i> is prime. Let <i>w</i> = 2 + √3, and <i>v</i> = 2 - √3. Then it is trivial to show
            (by induction) that S<i><sub>n</sub></i> = w<sup>2<sup><i>n</i>-1</sup></sup> +
            v<sup>2<sup><i>n</i>-1</sup></sup>.
            <!-- w<sup>2<sup><i>n</i>-1</sup></sup> + v<sup>2<sup><i>n</i>-1</sup></sup>. -->
            So M<i><sub>p</sub></i> divides S<sub><i>p</i>-1</sub> means there is an
            integer R such that
          </p>
          <p class="ml-4">
            w<sup>2<sup><i>p</i>-2</sup></sup> + v<sup>2<sup><i>p</i>-2</sup></sup>
            = RM<i><sub>p</sub></i> </p>
          <p>or (after we multiply by w<sup>2<sup><i>p</i>-2</sup></sup>
            and subtract one)</p>
          <p class="ml-4"> (1)&nbsp;&nbsp;
            w<sup>2<sup><i>p</i>-1</sup></sup> = RM<i><sub>p</sub></i> w<sup>2<sup><i>p</i>-2</sup></sup> - 1
            <!-- w</i><sup>2<sup><i>p</i>-2</sup></sup>-1 -->
          </p>
          <p>and squaring</p>
          <p class="ml-4"> (2)&nbsp;&nbsp; w<sup>2<sup><i>p</i></sup></sup> = (RM<i><sub>p</sub></i>
            w<sup>2<sup><i>p</i>-2</sup></sup> - 1)<sup>2</sup>. </p>
          <p>Now, for proof by contradiction, assume M<i><sub>p</sub></i> is composite
            and choose one of its prime divisors <i>q</i> that is not greater than its
            square root.</p>
          <p>Consider the group G = Z<i><sub>q</sub></i>[√3]<sup>*</sup> of all
            the numbers <i>a</i> + <i>b</i>sqrt(3) modulo <i>q</i> which are invertible.
            Note G has at most <i>q</i><sup>2</sup>-1 elements. Viewing <i>w</i> modulo <i>q</i>, the equalities (1) and
            (2) above become w<sup>2<sup><i>p</i>-1</sup></sup> = -1 and w<sup>2<sup><i>p</i></sup></sup> = 1
            respectively, showing <i>w</i> is an element of G with order 2<i><sup>p</sup></i>. Since the order of
            an element is at most the order of the group we have</p>
          <p class="ml-4"> 2<i><sup>p</sup></i> &le; <i>q</i><sup>2</sup> - 1 &lt; M<i><sub>p</sub></i> =
            2<i><sup>p</sup></i>-1 </p>
          <p>a contradiction, completing the proof of sufficiency.
            <span class="float-right" title="Q.E.D.">∎</span>
          </p>
        </dd>
      </dl> <!-- #EndEditable -->
    </div>
    <!-- For print copies only -->
    <div class="d-none d-print-block mt-5 pl-3">Printed from the PrimePages &lt;t5k.org&gt; &copy; Reginald McLean.
    </div>
  </main>
  <!--Main container-->

  <footer class="page-footer font-small indigo darken-3 pt-4 mt-4">

    <!-- Footer Links -->
    <div class="container text-center">

      <!-- Grid row -->
      <div class="row">


        <!-- hr class="clearfix w-100 d-md-none pb-3" -->

        <!-- Grid column -->
        <div class="col-sm-4 mt-md-0 mt-3 mb-3">
          <!-- Links -->
          <h5 class="font-weight-bold" id="cc_more">Collections</h5>
          <ul class="list-unstyled">
            <li><a href="/glossary/">Prime Glossary</a></li>
            <li><a href="/curios/">Prime Curios!</a></li>
            <li><a href="/prove/">Proving Primality</a></li>
            <li><a href="/notes/faq/">Frequently Asked Questions</a></li>
            <li><a href="/notes/proofs/">Proofs</a></li>
          </ul>
        </div>
        <!-- Grid column -->

        <!-- Grid column -->
        <div class="col-sm-4 mb-md-0 mb-3">
          <!-- Links -->
          <h5 class="font-weight-bold">Prime Lists</h5>
          <ul class="list-unstyled">
            <li><a href="/largest.html">Largest Known Primes</a></li>
            <li><a href="/primes/">Top 5000 List</a></li>
            <li><a href="/lists/">Lists of Small Primes</a></li>
            <li><a href="/top20/">Records for Different Types</a></li>
            <li><a href="/mersenne/">Mersenne Primes</a></li>
          </ul>
        </div>
        <!-- Grid column -->

        <!-- Grid column -->
        <div class="col-sm-4 mb-md-0 mb-3">
          <!-- Links -->
          <h5 class="font-weight-bold">Pages</h5>
          <ul class="list-unstyled">
            <li> <a href="/donate.php">Donate</a></li>
            <li> <a href="/notes/by_year.html">Largest Known by Year</a></li>
            <li> <a href="/bios/">Prover Bios</a></li>
            <li> <a href="/bios/top20.php">Top 20 Provers</a></li>
            <li> <a href="/primes/includes/mail.php">Contact Us</a></li>
          </ul>
        </div>
        <!-- Grid column -->

      </div>
      <!-- Grid row -->

    </div>
    <!-- Footer Links -->

    <div class="footer-copyright text-center py-3"><!-- #BeginLibraryItem "/Library/copyright.lbi" -->
      Copyright © 2021 &nbsp; <a href="https://t5k.org/">PrimePages</a>.&nbsp; (<a href="../privacy.html">Privacy
        notice</a>)<!-- #EndLibraryItem --></div>
  </footer>
  <!-- Footer -->

  <!-- THIS WAS NOT IN MD5:  jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <!-- XX script src="../js/jquery-3.3.1.min.js"></script -->
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <!-- XX script src="../js/popper.min.js"></script -->
  <!-- XX script src="../js/bootstrap-4.3.1.js"></script -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
</body>
<!-- #EndTemplate -->

</html>